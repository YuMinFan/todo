jQuery(function(t){"use strict";function e(){r=store.get("tasks")||[],d=store.get("flag")||0,o(),c(),l(),i(),a()}function n(t){r.push(t),store.set("tasks",r)}function o(){var e=t(".todo-list"),n=t(".filters a"),o=[];e.html(null),n.removeClass("selected"),0==r.length?(t(".main").hide(),t(".footer").hide()):(t(".main").show(),t(".footer").show()),t(r).each(function(t,c){switch(d){case 0:n.eq(0).attr("class","selected"),o=s(t,c),e.prepend(o);break;case 1:n.eq(1).attr("class","selected"),c.completed||(o=s(t,c),e.prepend(o));break;case 2:n.eq(2).attr("class","selected"),c.completed&&(o=s(t,c),e.prepend(o))}})}function s(t,e){return'<li data-index="'+t+'" class='+(e.completed?"completed":"")+'><div class="view"><input class="toggle" type="checkbox" '+(e.completed?"checked":"")+"><label>"+e.content+'</label><button class="destroy"></button></div><input class="edit" value="'+e.content+'"></li>'}function c(){t(".todo-list li").off("dblclick"),t(".todo-list li").on("dblclick",function(){t(this).addClass("editing");var n=t(this).find(".edit");n.focus().val(n.val()),n.on("blur",function(){n.parent().removeClass("editing");var o=t(this).parent().data("index");r[o].content=t(this).val(),store.set("tasks",r),e()}),n.on("keydown",function(o){if(13==o.which){n.parent().removeClass("editing");var s=t(this).parent().data("index");r[s].content=t(this).val(),stroe.set("tasks",r),e()}})})}function l(){t(".destroy").click(function(){var n=t(this).parent().parent().data("index");r.splice(n,1),store.set("tasks",r),e()})}function a(){t(".toggle").click(function(){var n=t(this).parent().parent().data("index");r[n].completed?r[n].completed=!1:r[n].completed=!0,store.set("tasks",r),e()})}function i(){for(var e=0,n=0;n<r.length;n++)r[n].completed&&e++;var o=r.length-e;t(".todo-count strong").text(o),0==e?t(".clear-completed").hide():t(".clear-completed").show();var s=t("#toggle-all");r.length==e?s.prop("checked","true"):s.prop("checked",null)}var r=[],d=0;e(),t(".new-todo").on("keydown",function(o){if(13==o.which){var s={};if(s.content=t(this).val(),!/.*[^ ].*/.test(s.content))return;n(s),t(this).val(null),e()}}),t(".clear-completed").on("click",function(){for(var t=0;t<r.length;t++)r[t].completed&&(r.splice(t,1),t-=1);store.set("tasks",r),e()}),t("#toggle-all").bind("click",function(){for(var n=0;n<r.length;n++)t(this).prop("checked")?r[n].completed=!0:r[n].completed=!1;store.set("tasks",r),e()}),t(".filters a").on("click",function(){var n=t(this).parent().index();store.set("flag",n),e()})});